# Strimzi Kafka Operator 설정
# Apache Kafka 공식 이미지 기반 (무료, 안정적)

# Kafka 클러스터 설정
kafka:
  version: 3.9.0
  replicas: 3
  
  # 리소스 설정
  resources:
    requests:
      memory: 256Mi
      cpu: 250m
    limits:
      memory: 512Mi
      cpu: 500m
  
  # 스토리지 설정
  storage:
    type: persistent-claim
    size: 10Gi
    class: gp3
    deleteClaim: false
  
  # 리스너 설정
  listeners:
    - name: plain
      port: 9092
      type: internal
      tls: false
    - name: tls
      port: 9093
      type: internal
      tls: true
  
  # Kafka 설정
  config:
    offsets.topic.replication.factor: 3
    transaction.state.log.replication.factor: 3
    transaction.state.log.min.isr: 2
    default.replication.factor: 3
    min.insync.replicas: 2
    inter.broker.protocol.version: "3.9"
    log.retention.hours: 168
    log.retention.bytes: 1073741824
    log.segment.bytes: 1073741824
    compression.type: producer
    auto.create.topics.enable: true
    num.partitions: 3
  
  # 메트릭 설정
  metricsConfig:
    type: jmxPrometheusExporter
    valueFrom:
      configMapKeyRef:
        name: kafka-metrics
        key: kafka-metrics-config.yml

# ZooKeeper 설정 (KRaft 모드 사용 시 불필요하지만 Strimzi는 아직 ZooKeeper 필요)
zookeeper:
  replicas: 3
  
  # 리소스 설정
  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 256Mi
      cpu: 200m
  
  # 스토리지 설정
  storage:
    type: persistent-claim
    size: 5Gi
    class: gp3
    deleteClaim: false

# Entity Operator 설정
entityOperator:
  topicOperator:
    resources:
      requests:
        memory: 64Mi
        cpu: 50m
      limits:
        memory: 128Mi
        cpu: 100m
  
  userOperator:
    resources:
      requests:
        memory: 64Mi
        cpu: 50m
      limits:
        memory: 128Mi
        cpu: 100m

# Kafka Exporter (메트릭)
kafkaExporter:
  enabled: true
  resources:
    requests:
      memory: 64Mi
      cpu: 50m
    limits:
      memory: 128Mi
      cpu: 100m
